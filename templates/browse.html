{% extends "base.html" %}
{% block title %}æµè§ˆæ–‡ä»¶ - {{ current_path or 'æ ¹ç›®å½•' }}{% endblock %}
{% block content %}
<div class="path-nav">
    <a href="/browse/">æ ¹ç›®å½•</a>
    {% for part in current_path.split('/') if part %}
        / <a href="/browse/{{ '/'.join(current_path.split('/')[:loop.index]) }}">{{ part }}</a>
    {% endfor %}
</div>

<ul class="file-tree">
    {% for item in items %}
        <li class="{% if item.is_dir %}folder{% else %}file{% endif %} {% if item.protected %}protected{% endif %}">
            {% if item.is_dir %}
                ğŸ“ <a href="/browse/{{ item.path }}">{{ item.name }}/</a>
            {% else %}
                ğŸ“„ <a href="/browse/{{ item.path }}">{{ item.name }}</a>
            {% endif %}
            {% if item.protected %}(éœ€è¦ç™»å½•){% endif %}
        </li>
    {% endfor %}
</ul>

{% if current_user.is_admin %}
    <hr>
    <h3>ç®¡ç†æ“ä½œ</h3>
    <form method="post" action="/admin">
        <input type="hidden" name="path" value="{{ current_path }}">
        <input type="text" name="path" placeholder="è¾“å…¥è·¯å¾„">
        <button type="submit" name="action" value="add">è®¾ä¸ºä¿æŠ¤è·¯å¾„</button>
        <button type="submit" name="action" value="remove">å–æ¶ˆä¿æŠ¤</button>
    </form>
{% endif %}
{% endblock %}